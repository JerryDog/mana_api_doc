


物理机项目联系人相关接口
====================

.. toctree::
   :maxdepth: 2
   :numbered:



概要
--------------------

获取项目下联系人信息，新增联系人，删除联系人，
主要获取 email 字段，用来指定邮件通知人


API规范
--------------------------

获取物理机API入口与API列表如下：


    * API入口: http://api.scloudm.com/
    * API列表:

+--------------------------+---------------------+------------+--------------------------+
|  资源                    |  操作               |  HTTP方法  |  URI路径                 |
+==========================+=====================+============+==========================+
|  /pm_contact/<tenant_id> |  获取项目联系人信息 |  GET       | /pm_contact/<tenant_id>  |
+--------------------------+---------------------+------------+--------------------------+
|  /pm_contact/<tenant_id> |  新增项目联系人信息 |  POST      | /pm_contact/<tenant_id>  |
+--------------------------+---------------------+------------+--------------------------+
|  /pm_contact/<tenant_id> |  删除项目联系人信息 |  DELETE    | /pm_contact/<tenant_id>  |
+--------------------------+---------------------+------------+--------------------------+

先认证并获取新令牌(已可用), 使用该令牌执行获取动作
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

+------------+------------------------------------+---------------------+
|  HTTP方法  |  URI路径                           |  描述               |
+============+====================================+=====================+
|  GET       |  /mana_api/pm_contact/<tenant_id>  |  获取项目联系人信息 |
+------------+------------------------------------+---------------------+
|  POST      |  /mana_api/pm_contact/<tenant_id>  |  新增项目联系人信息 |
+------------+------------------------------------+---------------------+
|  DELETE    |  /mana_api/pm_contact/<tenant_id>  |  删除项目联系人信息 |
+------------+------------------------------------+---------------------+


获取联系人请求参数

+-----------------------+----------+-----------------------------+
|  字段名               |  类型    |  描述                       |
+=======================+==========+=============================+
|  Sp-Agent             |  header  |  厂商类型如, 必须为scloudm  |
+-----------------------+----------+-----------------------------+
|  tenant_id            |  string  |  项目ID                     |
+-----------------------+----------+-----------------------------+


获取联系人列表请求样例

::


    curl  -i \
          -H 'X-Auth-Token: {token_id}' \
          -H 'Sp-Agent: scloudm' \
          -X GET 'http://api.scloudm.com/mana_api/pm_contact/j435jh345'



返回参数

+-------------------+-------------+-------------------------------------------------------------------------+
|  字段名           |  类型       |  描述                                                                   |
+===================+=============+=========================================================================+
|  contact_list     |  array      |  联系人列表                                                             |
+-------------------+-------------+-------------------------------------------------------------------------+
|  tenant_id        |  string     |  项目ID                                                                 |
+-------------------+-------------+-------------------------------------------------------------------------+
|  email            |  string     |  邮箱地址                                                               |
+-------------------+-------------+-------------------------------------------------------------------------+
|  phone            |  string     |  电话                                                                   |
+-------------------+-------------+-------------------------------------------------------------------------+
|  name             |  string     |  联系人姓名                                                             |
+-------------------+-------------+-------------------------------------------------------------------------+

返回样例

::


         HTTP/1.0 200 OK
         Content-Type: application/json
         Content-Length: 523
         Server: Werkzeug/0.10.4 Python/2.7.5
         Date: Fri, 01 Apr 2016 04:38:24 GMT

         {
           "code": 200,
           "msg": "",
           "contact_list": [{
             "tenant_id": "6test1234567",
             "email": "liujia@ztgame.com",
             "phone": "13805564478",
             "name": "史文俊"
           }]
         }



新增联系人请求参数

+-----------------------+----------+-----------------------------+
|  字段名               |  类型    |  描述                       |
+=======================+==========+=============================+
|  Sp-Agent             |  header  |  厂商类型如, 必须为scloudm  |
+-----------------------+----------+-----------------------------+
|  tenant_id            |  string  |  项目ID                     |
+-----------------------+----------+-----------------------------+
|  email                |  string  |  邮箱地址                   |
+-----------------------+----------+-----------------------------+
|  phone                |  string  |  电话                       |
+-----------------------+----------+-----------------------------+
|  name                 |  string  |  联系人姓名                 |
+-----------------------+----------+-----------------------------+

新增联系人请求样例

::


    curl  -i \
          -H 'X-Auth-Token: {token_id}' \
          -H 'Sp-Agent: scloudm' \
          -X POST 'http://api.scloudm.com/mana_api/pm_contact/j435jh345' \
          -d '{
            "email": "test@test.com",
            "phone": "13944403232",
            "name": "shiwenjun"
          }'


新增联系人返回样例

::


   HTTP/1.1 200 Bad Request
   {
     "msg": "add success",
     "code": 200,
   }





删除联系人请求参数

+-----------------------+----------+-----------------------------------+
|  字段名               |  类型    |  描述                             |
+=======================+==========+===================================+
|  Sp-Agent             |  header  |  厂商类型如, 必须为scloudm        |
+-----------------------+----------+-----------------------------------+
|  ids                  |  string  |  需要删除的联系id列表，逗号分隔   |
+-----------------------+----------+-----------------------------------+


删除联系人请求样例

::


    curl  -i \
          -H 'X-Auth-Token: {token_id}' \
          -H 'Sp-Agent: scloudm' \
          -X DELETE 'http://api.scloudm.com/mana_api/pm_contact/j435jh345?ids=123,456,789'



删除联系人返回样例

::


   HTTP/1.1 200 Bad Request
   {
     "msg": "delete success",
     "code": 200,
   }




错误返回样例

::


   HTTP/1.1 400 Bad Request
   {
     "msg": "Malformed request URL: URL's project_id 'e58c78fe826f4f0b890767a3e078101' doesn't match Context's project_id 'e58c78fe826f4f0b890767a3e0781019'",
     "code": 400,
     "reason": "Unauthorized"
   }