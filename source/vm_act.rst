


虚拟机电源接口
====================

.. toctree::
   :maxdepth: 2
   :numbered:




概要
--------------------

对虚拟机进行开关机重启操作


API规范
--------------------------

认证服务API入口与API列表如下：


    * API入口: http://api.scloudm.com/
    * API列表:

+------------------+------------------------------+------------+--------------------------------+
|  资源            |  操作                        |  HTTP方法  |  URI路径                       |
+==================+==============================+============+================================+
|  vm_act          |  开关机重启                  |  POST      |  /mana_api/vm_act              |
+------------------+------------------------------+------------+--------------------------------+


认证并生成新令牌(已可用)

+------------+---------------------------+------------------+
|  HTTP方法  |  URI路径                  |  描述            |
+============+===========================+==================+
|  POST      |  /mana_api/vm_act         |  开关机重启      |
+------------+---------------------------+------------------+

请求参数

+-----------------------+----------+--------------------------------------------------------------+
|  字段名               |  类型    |  描述                                                        |
+=======================+==========+==============================================================+
|  token                |  header  |  有效的 token                                                |
+-----------------------+----------+--------------------------------------------------------------+
|  Sp-Agent             |  header  |  厂商类型如：scloudm、pbs                                    |
+-----------------------+----------+--------------------------------------------------------------+
|  tenant_id（必选）    |  string  |  租户id                                                      |
+-----------------------+----------+--------------------------------------------------------------+
|  region（必选）       |  string  |  所属区域                                                    |
+-----------------------+----------+--------------------------------------------------------------+
|  servers（必选）      |  string  |  所操作的虚拟机ID列表，逗号分割                              |
+-----------------------+----------+--------------------------------------------------------------+
|  os-start	            |  string  |  开机动作 {'servers': 'id,id', 'os-start':null}              |
+-----------------------+----------+--------------------------------------------------------------+
|  os-stop	            |  string  |  关机动作 {'servers': 'id,id', 'os-stop ':null}              |
+-----------------------+----------+--------------------------------------------------------------+
|  reboot	            |  string  |  重启动作 {'servers': 'id,id', 'reboot ': {'type': 'HARD'}}  |
+-----------------------+----------+--------------------------------------------------------------+


请求样例

::

    
    curl -i \
         -X POST http://api.scloudm.com/mana_api/vm_act/{tenant_id}/{region}/{server_id} \
         -H 'X-Auth-Token: {token_id}' \
         -H 'Sp-Agent: scloudm' \
         -d '{
               "servers": "k432k234,a342fsd,234sdfg"
               "os-start": null
            }'


返回参数

只有返回码，无返回 body。


返回样例

::

    HTTP/1.0 200 OK



错误返回样例

::

   HTTP/1.1 400 Bad Request

   {
     "msg": "The request you have made requires authentication.",
     "code": 400,
     "reason": "Unauthorized"
   }